<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>My Collections</title>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        .collection-header {
            background-color: #f8f9fa;
            padding: 20px 0;
            border-bottom: 1px solid #e9ecef;
        }
        
        .collection-card {
            border-radius: 10px;
            transition: transform 0.2s, box-shadow 0.2s;
            margin-bottom: 20px;
            cursor: pointer;
        }
        
        .collection-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 20px rgba(0,0,0,0.1);
        }
        
        .collection-thumbnail {
            height: 150px;
            overflow: hidden;
            border-top-left-radius: 10px;
            border-top-right-radius: 10px;
            background-color: #f1f3f4;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        
        .collection-thumbnail i {
            font-size: 48px;
            color: #5f6368;
        }
        
        .collection-thumbnail img {
            width: 100%;
            height: 100%;
            object-fit: cover;
        }
        
        .collection-info {
            padding: 15px;
        }
        
        .view-toggle {
            cursor: pointer;
        }
        
        .list-view .collection-card {
            display: flex;
            height: 70px;
        }
        
        .list-view .collection-thumbnail {
            width: 70px;
            height: 70px;
            border-radius: 0;
            border-top-left-radius: 10px;
            border-bottom-left-radius: 10px;
        }
        
        .list-view .collection-info {
            display: flex;
            align-items: center;
            width: calc(100% - 70px);
        }
        
        .search-bar {
            max-width: 600px;
            margin: 0 auto;
        }
        
        .action-buttons button {
            background: none;
            border: none;
            color: #5f6368;
        }
        
        .action-buttons button:hover {
            color: #1a73e8;
        }
        
        .breadcrumb-item a {
            text-decoration: none;
            color: #5f6368;
        }
        
        .breadcrumb-item.active {
            color: #1a73e8;
        }
        
        .upload-button {
            background-color: #1a73e8;
            color: white;
            border-radius: 30px;
            padding: 8px 24px;
        }
        
        /* Dropdown menu styles */
        .context-menu {
            display: none;
            position: absolute;
            background-color: white;
            border-radius: 4px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
            z-index: 1000;
        }
        
        .context-menu a {
            display: block;
            padding: 8px 12px;
            text-decoration: none;
            color: #333;
        }
        
        .context-menu a:hover {
            background-color: #f8f9fa;
        }
    </style>
</head>
<body>
    <!-- Include your header/navigation template -->
    {% include 'header.html' %}

    <div class="collection-header">
        <div class="container">
            <div class="row align-items-center">
                <div class="col-md-7">
                    <nav aria-label="breadcrumb">
                        <ol class="breadcrumb mb-0">
                            <li class="breadcrumb-item"><a href="/collections">My Collections</a></li>
                            <li class="breadcrumb-item active" id="current-collection">All Items</li>
                        </ol>
                    </nav>
                </div>
                <div class="col-md-5 text-end">
                    <div class="action-buttons d-inline-block me-2">
                        <button id="view-toggle" title="Change view">
                            <i class="fas fa-th-list"></i>
                        </button>
                        <button id="sort-button" title="Sort items">
                            <i class="fas fa-sort"></i>
                        </button>
                    </div>
                    <button class="btn upload-button" data-bs-toggle="modal" data-bs-target="#uploadModal">
                        <i class="fas fa-plus me-1"></i> New
                    </button>
                </div>
            </div>
            
            <div class="row mt-3">
                <div class="col-12">
                    <div class="search-bar input-group">
                        <span class="input-group-text bg-white border-end-0">
                            <i class="fas fa-search text-muted"></i>
                        </span>
                        <input type="text" id="search-collections" class="form-control border-start-0" placeholder="Search in collections">
                    </div>
                </div>
            </div>
        </div>
    </div>

    <div class="container mt-4">
        <!-- Collections section -->
        <div class="row mb-4">
            <div class="col-12">
                <h5 class="mb-3">Collections</h5>
                <div class="row" id="collections-container">
                    <!-- Collection cards will be generated here -->
                </div>
            </div>
        </div>
        
        <!-- Files section -->
        <div class="row">
            <div class="col-12">
                <h5 class="mb-3">Files</h5>
                <div class="row" id="files-container">
                    <!-- File cards will be generated here -->
                </div>
            </div>
        </div>
    </div>
    
    <!-- Context Menu -->
    <div class="context-menu" id="context-menu">
        <a href="#" id="open-item"><i class="fas fa-folder-open me-2"></i>Open</a>
        <a href="#" id="share-item"><i class="fas fa-share-alt me-2"></i>Share</a>
        <a href="#" id="download-item"><i class="fas fa-download me-2"></i>Download</a>
        <a href="#" id="rename-item"><i class="fas fa-edit me-2"></i>Rename</a>
        <a href="#" id="move-item"><i class="fas fa-arrow-right me-2"></i>Move to</a>
        <a href="#" id="delete-item" class="text-danger"><i class="fas fa-trash-alt me-2"></i>Delete</a>
    </div>
    
    <!-- Upload Modal -->
    <div class="modal fade" id="uploadModal" tabindex="-1" aria-labelledby="uploadModalLabel" aria-hidden="true">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="uploadModalLabel">Create New</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
                    <ul class="nav nav-tabs" id="createTab" role="tablist">
                        <li class="nav-item" role="presentation">
                            <button class="nav-link active" id="collection-tab" data-bs-toggle="tab" 
                                    data-bs-target="#collection" type="button" role="tab">Collection</button>
                        </li>
                        <li class="nav-item" role="presentation">
                            <button class="nav-link" id="upload-tab" data-bs-toggle="tab" 
                                    data-bs-target="#upload" type="button" role="tab">Upload Files</button>
                        </li>
                    </ul>
                    <div class="tab-content mt-3" id="createTabContent">
                        <div class="tab-pane fade show active" id="collection" role="tabpanel">
                            <form id="create-collection-form">
                                <div class="mb-3">
                                    <label for="collection-name" class="form-label">Collection Name</label>
                                    <input type="text" class="form-control" id="collection-name" required>
                                </div>
                                <button type="submit" class="btn btn-primary">Create Collection</button>
                            </form>
                        </div>
                        <div class="tab-pane fade" id="upload" role="tabpanel">
                            <form id="upload-files-form">
                                <div class="mb-3">
                                    <label for="file-upload" class="form-label">Choose Files</label>
                                    <input class="form-control" type="file" id="file-upload" multiple>
                                </div>
                                <div class="mb-3">
                                    <label for="upload-destination" class="form-label">Destination Collection</label>
                                    <select class="form-select" id="upload-destination">
                                        <option value="root">My Collections (root)</option>
                                        <!-- Other collection options will be loaded dynamically -->
                                    </select>
                                </div>
                                <button type="submit" class="btn btn-primary">Upload Files</button>
                            </form>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Bootstrap and Other Scripts -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    
    <script>
        // Sample data for demonstration
        const collections = [
            { id: 1, name: "Photos", items: 42, lastModified: "2023-06-15" },
            { id: 2, name: "Documents", items: 17, lastModified: "2023-06-10" },
            { id: 3, name: "Projects", items: 5, lastModified: "2023-06-05" }
        ];
        
        const files = [
            { id: 101, name: "vacation.jpg", type: "image", size: "2.4 MB", lastModified: "2023-06-14" },
            { id: 102, name: "report.pdf", type: "pdf", size: "1.2 MB", lastModified: "2023-06-12" },
            { id: 103, name: "presentation.pptx", type: "powerpoint", size: "4.7 MB", lastModified: "2023-06-11" },
            { id: 104, name: "notes.txt", type: "text", size: "12 KB", lastModified: "2023-06-09" }
        ];

        // Function to render collection cards
        function renderCollections() {
            const container = document.getElementById('collections-container');
            container.innerHTML = '';
            
            collections.forEach(collection => {
                const card = document.createElement('div');
                card.className = 'col-md-3 col-sm-6';
                card.innerHTML = `
                    <div class="card collection-card" data-id="${collection.id}" data-type="collection">
                        <div class="collection-thumbnail">
                            <i class="fas fa-folder"></i>
                        </div>
                        <div class="collection-info">
                            <h6 class="card-title mb-0">${collection.name}</h6>
                            <small class="text-muted">${collection.items} items · ${collection.lastModified}</small>
                        </div>
                    </div>
                `;
                container.appendChild(card);
            });
            
            attachEventListeners();
        }
        
        // Function to render file cards
        function renderFiles() {
            const container = document.getElementById('files-container');
            container.innerHTML = '';
            
            files.forEach(file => {
                const card = document.createElement('div');
                card.className = 'col-md-3 col-sm-6';
                
                // Choose icon based on file type
                let icon = 'fa-file';
                if (file.type === 'image') icon = 'fa-image';
                if (file.type === 'pdf') icon = 'fa-file-pdf';
                if (file.type === 'powerpoint') icon = 'fa-file-powerpoint';
                if (file.type === 'text') icon = 'fa-file-alt';
                
                card.innerHTML = `
                    <div class="card collection-card" data-id="${file.id}" data-type="file">
                        <div class="collection-thumbnail">
                            <i class="fas ${icon}"></i>
                        </div>
                        <div class="collection-info">
                            <h6 class="card-title mb-0">${file.name}</h6>
                            <small class="text-muted">${file.size} · ${file.lastModified}</small>
                        </div>
                    </div>
                `;
                container.appendChild(card);
            });
            
            attachEventListeners();
        }
        
        // Toggle between grid and list view
        function toggleView() {
            const collectionsContainer = document.getElementById('collections-container');
            const filesContainer = document.getElementById('files-container');
            const viewToggleButton = document.getElementById('view-toggle');
            
            if (collectionsContainer.parentElement.classList.contains('list-view')) {
                collectionsContainer.parentElement.classList.remove('list-view');
                filesContainer.parentElement.classList.remove('list-view');
                viewToggleButton.innerHTML = '<i class="fas fa-th-list"></i>';
            } else {
                collectionsContainer.parentElement.classList.add('list-view');
                filesContainer.parentElement.classList.add('list-view');
                viewToggleButton.innerHTML = '<i class="fas fa-th"></i>';
            }
        }
        
        // Attach event listeners to cards and buttons
        function attachEventListeners() {
            // Add click event to all cards
            document.querySelectorAll('.collection-card').forEach(card => {
                card.addEventListener('click', function(e) {
                    const id = this.getAttribute('data-id');
                    const type = this.getAttribute('data-type');
                    
                    if (type === 'collection') {
                        // Navigate to the collection
                        console.log('Opening collection:', id);
                        // In real implementation, you would redirect or load collection content
                    } else {
                        // Open the file
                        console.log('Opening file:', id);
                        // In real implementation, you would open the file
                    }
                });
                
                // Add context menu
                card.addEventListener('contextmenu', function(e) {
                    e.preventDefault();
                    const menu = document.getElementById('context-menu');
                    menu.style.display = 'block';
                    menu.style.left = e.pageX + 'px';
                    menu.style.top = e.pageY + 'px';
                    
                    // Store the selected item
                    menu.setAttribute('data-target-id', this.getAttribute('data-id'));
                    menu.setAttribute('data-target-type', this.getAttribute('data-type'));
                });
            });
            
            // View toggle button
            document.getElementById('view-toggle').addEventListener('click', toggleView);
            
            // Hide context menu when clicking outside
            document.addEventListener('click', function() {
                document.getElementById('context-menu').style.display = 'none';
            });
            
            // Context menu actions
            document.getElementById('open-item').addEventListener('click', function(e) {
                e.preventDefault();
                const menu = document.getElementById('context-menu');
                const id = menu.getAttribute('data-target-id');
                const type = menu.getAttribute('data-target-type');
                console.log('Opening', type, 'with id:', id);
                menu.style.display = 'none';
            });
            
            document.getElementById('share-item').addEventListener('click', function(e) {
                e.preventDefault();
                const menu = document.getElementById('context-menu');
                const id = menu.getAttribute('data-target-id');
                console.log('Sharing item with id:', id);
                menu.style.display = 'none';
                // Show sharing modal in real implementation
            });
            
            document.getElementById('download-item').addEventListener('click', function(e) {
                e.preventDefault();
                const menu = document.getElementById('context-menu');
                const id = menu.getAttribute('data-target-id');
                console.log('Downloading item with id:', id);
                menu.style.display = 'none';
                // Trigger download in real implementation
            });
            
            document.getElementById('rename-item').addEventListener('click', function(e) {
                e.preventDefault();
                const menu = document.getElementById('context-menu');
                const id = menu.getAttribute('data-target-id');
                const newName = prompt('Enter new name:');
                if (newName) {
                    console.log('Renaming item with id:', id, 'to:', newName);
                }
                menu.style.display = 'none';
            });
            
            document.getElementById('move-item').addEventListener('click', function(e) {
                e.preventDefault();
                const menu = document.getElementById('context-menu');
                const id = menu.getAttribute('data-target-id');
                console.log('Moving item with id:', id);
                menu.style.display = 'none';
                // Show move dialog in real implementation
            });
            
            document.getElementById('delete-item').addEventListener('click', function(e) {
                e.preventDefault();
                const menu = document.getElementById('context-menu');
                const id = menu.getAttribute('data-target-id');
                if (confirm('Are you sure you want to delete this item?')) {
                    console.log('Deleting item with id:', id);
                    // Delete item in real implementation
                }
                menu.style.display = 'none';
            });
            
            // Form submissions
            document.getElementById('create-collection-form').addEventListener('submit', function(e) {
                e.preventDefault();
                const collectionName = document.getElementById('collection-name').value;
                console.log('Creating new collection:', collectionName);
                
                // In real implementation, you would send this to your backend
                // And then update the UI with the new collection
                
                // Close the modal
                const modal = bootstrap.Modal.getInstance(document.getElementById('uploadModal'));
                modal.hide();
            });
            
            document.getElementById('upload-files-form').addEventListener('submit', function(e) {
                e.preventDefault();
                const files = document.getElementById('file-upload').files;
                const destination = document.getElementById('upload-destination').value;
                
                console.log(`Uploading ${files.length} files to destination:`, destination);
                
                // In real implementation, you would send these files to your backend
                // And then update the UI with the new files
                
                // Close the modal
                const modal = bootstrap.Modal.getInstance(document.getElementById('uploadModal'));
                modal.hide();
            });
            
            // Search functionality
            document.getElementById('search-collections').addEventListener('input', function(e) {
                const searchTerm = e.target.value.toLowerCase();
                console.log('Searching for:', searchTerm);
                
                // In real implementation, you would filter the displayed items
                // based on the search term
            });
        }
        
        // Initialize the page
        document.addEventListener('DOMContentLoaded', function() {
            renderCollections();
            renderFiles();
        });
    </script>
</body>
</html>